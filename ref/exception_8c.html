<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdragon: exception.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo2.png"/></td>
  <td id="projectalign">
   <div id="projectname">libdragon
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">exception.c File Reference<div class="ingroups"><a class="el" href="group__libdragon.html">libdragon</a> &raquo; <a class="el" href="group__lowlevel.html">Low Level Hardware Interfaces</a> &raquo; <a class="el" href="group__exceptions.html">Exception Handler</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Exception Handler.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structsyscall__handler__entry__t" id="r_structsyscall__handler__entry__t"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="exception_8c.html#structsyscall__handler__entry__t">syscall_handler_entry_t</a></td></tr>
<tr class="memdesc:structsyscall__handler__entry__t"><td class="mdescLeft">&#160;</td><td class="mdescRight">Syscall exception handler entry.  <a href="exception_8c.html#structsyscall__handler__entry__t">More...</a><br /></td></tr>
<tr class="separator:structsyscall__handler__entry__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acc6936ec7217ab33cafead5d46266c8e" id="r_acc6936ec7217ab33cafead5d46266c8e"><td class="memItemLeft" align="right" valign="top"><a id="acc6936ec7217ab33cafead5d46266c8e" name="acc6936ec7217ab33cafead5d46266c8e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_SYSCALL_HANDLERS</b>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:acc6936ec7217ab33cafead5d46266c8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of syscall handlers that can be registered. <br /></td></tr>
<tr class="separator:acc6936ec7217ab33cafead5d46266c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a20f7ab774d736160a00431ccaf8636a6" id="r_a20f7ab774d736160a00431ccaf8636a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="exception_8h.html#a4296110877efb56862a467ee1ab633bd">exception_handler_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="exception_8c.html#a20f7ab774d736160a00431ccaf8636a6">register_exception_handler</a> (<a class="el" href="exception_8h.html#a4296110877efb56862a467ee1ab633bd">exception_handler_t</a> cb)</td></tr>
<tr class="memdesc:a20f7ab774d736160a00431ccaf8636a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register an exception handler to handle exceptions.  <br /></td></tr>
<tr class="separator:a20f7ab774d736160a00431ccaf8636a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b5bc4d67c381300360c1a543924f1e" id="r_a72b5bc4d67c381300360c1a543924f1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="exception_8c.html#a72b5bc4d67c381300360c1a543924f1e">__exception_dump_header</a> (FILE *out, <a class="el" href="group__exceptions.html#structexception__t">exception_t</a> *ex)</td></tr>
<tr class="memdesc:a72b5bc4d67c381300360c1a543924f1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump a brief recap of the exception.  <br /></td></tr>
<tr class="separator:a72b5bc4d67c381300360c1a543924f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c282d6503102d85e52682a974c18d7d" id="r_a5c282d6503102d85e52682a974c18d7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="exception_8c.html#a5c282d6503102d85e52682a974c18d7d">__exception_dump_gpr</a> (<a class="el" href="group__exceptions.html#structexception__t">exception_t</a> *ex, void(*cb)(void *arg, const char *regname, char *value), void *arg)</td></tr>
<tr class="memdesc:a5c282d6503102d85e52682a974c18d7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to dump the GPRs of an exception.  <br /></td></tr>
<tr class="separator:a5c282d6503102d85e52682a974c18d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832fbc2ed1f8b5653cfbab04333015f8" id="r_a832fbc2ed1f8b5653cfbab04333015f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="exception_8c.html#a832fbc2ed1f8b5653cfbab04333015f8">__exception_dump_fpr</a> (<a class="el" href="group__exceptions.html#structexception__t">exception_t</a> *ex, void(*cb)(void *arg, const char *regname, char *hexvalue, char *singlevalue, char *doublevalue), void *arg)</td></tr>
<tr class="memdesc:a832fbc2ed1f8b5653cfbab04333015f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper to dump the FPRs of an exception.  <br /></td></tr>
<tr class="separator:a832fbc2ed1f8b5653cfbab04333015f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ccc97f57a66f0091daa6529c4f52573" id="r_a2ccc97f57a66f0091daa6529c4f52573"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="exception_8c.html#a2ccc97f57a66f0091daa6529c4f52573">exception_default_handler</a> (<a class="el" href="group__exceptions.html#structexception__t">exception_t</a> *ex)</td></tr>
<tr class="memdesc:a2ccc97f57a66f0091daa6529c4f52573"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default exception handler.  <br /></td></tr>
<tr class="separator:a2ccc97f57a66f0091daa6529c4f52573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16798befa2f7beac6fc7c574de0810c1" id="r_a16798befa2f7beac6fc7c574de0810c1"><td class="memItemLeft" align="right" valign="top"><a id="a16798befa2f7beac6fc7c574de0810c1" name="a16798befa2f7beac6fc7c574de0810c1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>__onCriticalException</b> (<a class="el" href="group__exceptions.html#structreg__block__t">reg_block_t</a> *regs)</td></tr>
<tr class="memdesc:a16798befa2f7beac6fc7c574de0810c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Respond to a critical exception. <br /></td></tr>
<tr class="separator:a16798befa2f7beac6fc7c574de0810c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84782b20b1cf9cec7ca102080962c965" id="r_a84782b20b1cf9cec7ca102080962c965"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="exception_8c.html#a84782b20b1cf9cec7ca102080962c965">register_syscall_handler</a> (<a class="el" href="exception_8h.html#aceadbbfdaee48a1075dac31bddc20d1c">syscall_handler_t</a> handler, uint32_t first_code, uint32_t last_code)</td></tr>
<tr class="memdesc:a84782b20b1cf9cec7ca102080962c965"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a handler that will be called when a syscall exception.  <br /></td></tr>
<tr class="separator:a84782b20b1cf9cec7ca102080962c965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae435d7992edb8cc7907a7f3e6d208c2f" id="r_ae435d7992edb8cc7907a7f3e6d208c2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="exception_8c.html#ae435d7992edb8cc7907a7f3e6d208c2f">__onSyscallException</a> (<a class="el" href="group__exceptions.html#structreg__block__t">reg_block_t</a> *regs)</td></tr>
<tr class="memdesc:ae435d7992edb8cc7907a7f3e6d208c2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Respond to a syscall exception.  <br /></td></tr>
<tr class="separator:ae435d7992edb8cc7907a7f3e6d208c2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aeb336a150cd15bd969c9067b0bca7ef9" id="r_aeb336a150cd15bd969c9067b0bca7ef9"><td class="memItemLeft" align="right" valign="top"><a id="aeb336a150cd15bd969c9067b0bca7ef9" name="aeb336a150cd15bd969c9067b0bca7ef9"></a>
volatile <a class="el" href="group__exceptions.html#structreg__block__t">reg_block_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>__baseRegAddr</b></td></tr>
<tr class="memdesc:aeb336a150cd15bd969c9067b0bca7ef9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base register offset as defined by the interrupt controller. <br /></td></tr>
<tr class="separator:aeb336a150cd15bd969c9067b0bca7ef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Exception Handler. </p>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structsyscall__handler__entry__t" id="structsyscall__handler__entry__t"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structsyscall__handler__entry__t">&#9670;&#160;</a></span>syscall_handler_entry_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct syscall_handler_entry_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Syscall exception handler entry. </p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a3fa2cee6b15190c4dc4332496836d87e" name="a3fa2cee6b15190c4dc4332496836d87e"></a><a class="el" href="exception_8h.html#aceadbbfdaee48a1075dac31bddc20d1c">syscall_handler_t</a></td>
<td class="fieldname">
handler</td>
<td class="fielddoc">
Exception handler. </td></tr>
<tr><td class="fieldtype">
<a id="a2e15351dcb8638e7a369b9eaa171e05e" name="a2e15351dcb8638e7a369b9eaa171e05e"></a>uint32_t</td>
<td class="fieldname">
first_code</td>
<td class="fielddoc">
Syscall code range start. </td></tr>
<tr><td class="fieldtype">
<a id="a9fa2435054b572b9cad571543be9350a" name="a9fa2435054b572b9cad571543be9350a"></a>uint32_t</td>
<td class="fieldname">
last_code</td>
<td class="fielddoc">
Syscall code range end. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a20f7ab774d736160a00431ccaf8636a6" name="a20f7ab774d736160a00431ccaf8636a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f7ab774d736160a00431ccaf8636a6">&#9670;&#160;</a></span>register_exception_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="exception_8h.html#a4296110877efb56862a467ee1ab633bd">exception_handler_t</a> register_exception_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="exception_8h.html#a4296110877efb56862a467ee1ab633bd">exception_handler_t</a>&#160;</td>
          <td class="paramname"><em>cb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register an exception handler to handle exceptions. </p>
<p>The registered handle is responsible for clearing any bits that may cause a re-trigger of the same exception and updating the EPC. An important example is the cause bits (12-17) of FCR31 from cop1. To prevent re-triggering the exception they should be cleared by the handler.</p>
<p>To manipulate the registers, update the values in the <a class="el" href="group__exceptions.html#structexception__t" title="Structure representing an exception.">exception_t</a> struct. They will be restored to appropriate locations when returning from the handler. Setting them directly will not work as expected as they will get overwritten with the values pointed by the struct.</p>
<p>There is only one exception to this, cr (cause register) which is also modified by the int handler before the saved values are restored thus it is only possible to update it through C0_WRITE_CR macro if it is needed. This shouldn't be necessary though as they are already handled by the library.</p>
<p>k0 ($26), k1 ($27) are not saved/restored and will not be available in the handler. Theoretically we can exclude s0-s7 ($16-$23), and gp ($28) to gain some performance as they are already saved by GCC when necessary. The same is true for sp ($29) and ra ($31) but current interrupt handler manipulates them via allocating a new stack and doing a jal. Similarly floating point registers f21-f31 are callee-saved. In the future we may consider removing them from the save state for interrupts (but not for exceptions)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cb</td><td>Callback function to call when exceptions happen </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a72b5bc4d67c381300360c1a543924f1e" name="a72b5bc4d67c381300360c1a543924f1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72b5bc4d67c381300360c1a543924f1e">&#9670;&#160;</a></span>__exception_dump_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __exception_dump_header </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__exceptions.html#structexception__t">exception_t</a> *&#160;</td>
          <td class="paramname"><em>ex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump a brief recap of the exception. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">out</td><td>File to write to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ex</td><td>Exception to dump </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5c282d6503102d85e52682a974c18d7d" name="a5c282d6503102d85e52682a974c18d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c282d6503102d85e52682a974c18d7d">&#9670;&#160;</a></span>__exception_dump_gpr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __exception_dump_gpr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__exceptions.html#structexception__t">exception_t</a> *&#160;</td>
          <td class="paramname"><em>ex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *arg, const char *regname, char *value)&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper to dump the GPRs of an exception. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ex</td><td>Exception </td></tr>
    <tr><td class="paramname">cb</td><td>Callback that will be called for each register </td></tr>
    <tr><td class="paramname">arg</td><td>Argument to pass to the callback </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a832fbc2ed1f8b5653cfbab04333015f8" name="a832fbc2ed1f8b5653cfbab04333015f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832fbc2ed1f8b5653cfbab04333015f8">&#9670;&#160;</a></span>__exception_dump_fpr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __exception_dump_fpr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__exceptions.html#structexception__t">exception_t</a> *&#160;</td>
          <td class="paramname"><em>ex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *arg, const char *regname, char *hexvalue, char *singlevalue, char *doublevalue)&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper to dump the FPRs of an exception. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ex</td><td>Exception </td></tr>
    <tr><td class="paramname">cb</td><td>Callback that will be called for each register </td></tr>
    <tr><td class="paramname">arg</td><td>Argument to pass to the callback </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2ccc97f57a66f0091daa6529c4f52573" name="a2ccc97f57a66f0091daa6529c4f52573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ccc97f57a66f0091daa6529c4f52573">&#9670;&#160;</a></span>exception_default_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void exception_default_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__exceptions.html#structexception__t">exception_t</a> *&#160;</td>
          <td class="paramname"><em>ex</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default exception handler. </p>
<p>This handler is installed by default for all exceptions. It initializes the console and dump the exception state to the screen, including the value of all GPR/FPR registers. It then calls abort() to abort execution. </p>

</div>
</div>
<a id="a84782b20b1cf9cec7ca102080962c965" name="a84782b20b1cf9cec7ca102080962c965"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84782b20b1cf9cec7ca102080962c965">&#9670;&#160;</a></span>register_syscall_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void register_syscall_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="exception_8h.html#aceadbbfdaee48a1075dac31bddc20d1c">syscall_handler_t</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>first_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>last_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a handler that will be called when a syscall exception. </p>
<p>This function allows to register a handler to be invoked in response to a syscall exception, generated by the SYSCALL opcode. The opcode allows to specify a 20-bit code which, in a more traditional operating system architecture, corresponds to the "service" to be called.</p>
<p>When the registered handler returns, the execution will resume from the instruction following the syscall one.</p>
<p>To allow for different usages of the code field, this function accepts a range of codes to associated with the handler. This allows a single handler to be invoked for multiple different codes, to specialize services.</p>
<dl class="section note"><dt>Note</dt><dd>Syscall codes in the range 0x00000 - 0x0FFFF are reserved to libdragon itself. Use a code outside that range to avoid conflicts with future versions of libdragon.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>Handler to invoke when a syscall exception is triggered </td></tr>
    <tr><td class="paramname">first_code</td><td>First syscall code to associate with this handler (begin of range) </td></tr>
    <tr><td class="paramname">last_code</td><td>Last syscall code to associate with this handler (end of range) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae435d7992edb8cc7907a7f3e6d208c2f" name="ae435d7992edb8cc7907a7f3e6d208c2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae435d7992edb8cc7907a7f3e6d208c2f">&#9670;&#160;</a></span>__onSyscallException()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __onSyscallException </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__exceptions.html#structreg__block__t">reg_block_t</a> *&#160;</td>
          <td class="paramname"><em>regs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Respond to a syscall exception. </p>
<p>Calls the handlers registered by <a class="el" href="exception_8c.html#a84782b20b1cf9cec7ca102080962c965" title="Register a handler that will be called when a syscall exception.">register_syscall_handler</a>. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 24 2024 23:03:56 for libdragon by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
