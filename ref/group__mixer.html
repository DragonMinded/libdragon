<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libdragon: Audio mixer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo2.png"/></td>
  <td id="projectalign">
   <div id="projectname">libdragon
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle"><div class="title">Audio mixer<div class="ingroups"><a class="el" href="group__libdragon.html">libdragon</a> &raquo; <a class="el" href="group__audio.html">Audio Subsystem</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Flexible, composable, fast, RSP-based audio mixer.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:mixer_8c" id="r_mixer_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mixer_8c.html">mixer.c</a></td></tr>
<tr class="memdesc:mixer_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSP Audio mixer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:samplebuffer_8c" id="r_samplebuffer_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="samplebuffer_8c.html">samplebuffer.c</a></td></tr>
<tr class="memdesc:samplebuffer_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample buffer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:wav64_8c" id="r_wav64_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wav64_8c.html">wav64.c</a></td></tr>
<tr class="memdesc:wav64_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Support for WAV64 audio files. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:xm64_8c" id="r_xm64_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xm64_8c.html">xm64.c</a></td></tr>
<tr class="memdesc:xm64_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Efficient XM module player. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ym64_8c" id="r_ym64_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ym64_8c.html">ym64.c</a></td></tr>
<tr class="memdesc:ym64_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Player for the .YM64 module format (Arkos Tracker 2) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:mixer_8h" id="r_mixer_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mixer_8h.html">mixer.h</a></td></tr>
<tr class="memdesc:mixer_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">RSP Audio mixer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:samplebuffer_8h" id="r_samplebuffer_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="samplebuffer_8h.html">samplebuffer.h</a></td></tr>
<tr class="memdesc:samplebuffer_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample buffer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:wav64_8h" id="r_wav64_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wav64_8h.html">wav64.h</a></td></tr>
<tr class="memdesc:wav64_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Support for WAV64 audio files. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:xm64_8h" id="r_xm64_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="xm64_8h.html">xm64.h</a></td></tr>
<tr class="memdesc:xm64_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Efficient XM module player. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ym64_8h" id="r_ym64_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ym64_8h.html">ym64.h</a></td></tr>
<tr class="memdesc:ym64_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Player for the .YM64 module format (Arkos Tracker 2) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Flexible, composable, fast, RSP-based audio mixer. </p>
<p>This module offers a flexible API to mix and play up to 32 independent audio streams called "waveforms". It also supports resampling: each waveform can play at a different playback frequency, which in turn can be different from the final output frequency. The resampling and mixing is performed by a very efficient RSP microcode (see rsp_mixer.S).</p>
<p>The mixer exposes 32 channels that can be used to play different audio sources. An audio source is called a "waveform", and is represented by the type <a class="el" href="mixer_8h.html#structwaveform__t" title="A waveform that can be played back through the mixer.">waveform_t</a>. To be able to produce audio that can be mixed (eg: decompress and playback a MP3 file), the decoder/player code must implement a <a class="el" href="mixer_8h.html#structwaveform__t" title="A waveform that can be played back through the mixer.">waveform_t</a>.</p>
<p><a class="el" href="mixer_8h.html#structwaveform__t" title="A waveform that can be played back through the mixer.">waveform_t</a> can be thought of as a "sample generator". The mixer does not force the whole audio stream to be decompressed in memory before playing, but rather work using callbacks: whenever new samples are required, a specific callback (defined in the <a class="el" href="mixer_8h.html#structwaveform__t" title="A waveform that can be played back through the mixer.">waveform_t</a> instance) is called, and the callback is expected to decompress and store a chunk of samples into a buffer provided by the mixer. This allows full decoupling between the mixer and the different audio players. Audio players are free to generate audio samples as they wish (eg: via RSP), as long as they honor the <a class="el" href="mixer_8h.html#structwaveform__t" title="A waveform that can be played back through the mixer.">waveform_t</a> protocol. See <a class="el" href="mixer_8h.html#structwaveform__t" title="A waveform that can be played back through the mixer.">waveform_t</a> for more information.</p>
<p>One of the main design goals for the mixer is to provide an efficient way to compose different audio sources. To achieve full flexibility without impacting speed, the mixer tries to honor the "CPU zero copy" design principle: samples are (almost) never touched or moved around with CPU. The whole API has been carefully designed so that audio players can produce samples directly into a mixer-provided buffer, so that the mixer can then resample and mix them on the RSP and store the final output stream directly in the final buffer which is sent via DMA to the N64 AI hardware DAC. In general, the N64 CPU is very bandwidth-limited on RDRAM accesses, so "touching" 44100 samples per second with the CPU would already consume too many resources. Audio players are expected to use RSP to produce the audio samples as well, so that the full audio pipeline can work totally off CPU. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 11 2024 19:58:15 for libdragon by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
